{% extends "base.html" %}

{% block title %}Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙˆÙ† - Ù…Ù†ØµØ© Ø§Ù„ØªÙˆØ¸ÙŠÙ{% endblock %}

{% block content %}
<div class="container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <div>
            <h1 style="margin-bottom: 0.5rem;">{{ job.title }}</h1>
            <p style="color: #6b7280;">{{ applications|length }} Ù…ØªÙ‚Ø¯Ù…</p>
        </div>
        <a href="{{ url_for('company_dashboard') }}" class="btn btn-secondary">â† Ø§Ù„Ø¹ÙˆØ¯Ø©</a>
    </div>

    {% if applications %}
        <div style="background: white; border-radius: 0.75rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;">
            {% for app in applications %}
                <div style="padding: 1.5rem; border-bottom: 1px solid #e5e7eb; {% if loop.last %}border-bottom: none;{% endif %}">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                        <div>
                            <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem;">{{ app.seeker.full_name }}</h3>
                            <p style="color: #6b7280; font-size: 0.9rem;">{{ app.seeker.email }} | {{ app.seeker.phone }}</p>
                            <p style="color: #6b7280; font-size: 0.9rem;">ğŸ“ {{ app.seeker.city }}</p>
                        </div>
                        <span class="job-status status-{{ app.status.lower() }}">
                            {% if app.status == 'Pending' %}
                                Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
                            {% elif app.status == 'Accepted' %}
                                Ù…Ù‚Ø¨ÙˆÙ„
                            {% else %}
                                Ù…Ø±ÙÙˆØ¶
                            {% endif %}
                        </span>
                    </div>

                    {% if app.cover_letter %}
                        <div style="background: #f3f4f6; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                            <p style="font-weight: bold; margin-bottom: 0.5rem;">Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…:</p>
                            <p style="color: #4b5563; line-height: 1.6;">{{ app.cover_letter }}</p>
                        </div>
                    {% endif %}

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <p style="color: #6b7280; font-size: 0.9rem;">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</p>
                            <p style="font-weight: bold;">{{ app.applied_at.strftime('%d-%m-%Y %H:%M') }}</p>
                        </div>
                        {% if app.cv_filename %}
                            <div>
                                <p style="color: #6b7280; font-size: 0.9rem;">Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©</p>
                                <a href="{{ url_for('download_cv', filename=app.cv_filename) }}" class="btn btn-secondary" style="font-size: 0.85rem; display: inline-block;">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ CV</a>
                            </div>
                        {% else %}
                            <div>
                                <p style="color: #6b7280; font-size: 0.9rem;">Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©</p>
                                <p style="color: #ef4444; font-size: 0.85rem;">Ù„Ù… ÙŠØªÙ… Ø±ÙØ¹ Ù…Ù„Ù</p>
                            </div>
                        {% endif %}
                    </div>

                    {% if app.internal_notes %}
                        <div style="background: #fef3c7; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; border-right: 4px solid #f59e0b;">
                            <p style="font-weight: bold; margin-bottom: 0.5rem;">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¯Ø§Ø®Ù„ÙŠØ©:</p>
                            <p style="color: #92400e;">{{ app.internal_notes }}</p>
                        </div>
                    {% endif %}

                    <!-- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e5e7eb;">
                        <div class="form-group" style="margin-bottom: 0;">
                            <label for="notes-{{ app.application_id }}" style="font-size: 0.9rem;">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                            <textarea id="notes-{{ app.application_id }}" placeholder="Ø£Ø¶Ù Ù…Ù„Ø§Ø­Ø¸Ø§Øª..." style="min-height: 80px;"></textarea>
                        </div>
                        <div style="display: flex; gap: 0.5rem; align-items: flex-end;">
                            <button onclick="updateApplicationStatus({{ app.application_id }}, 'Accepted')" class="btn btn-success" style="flex: 1;">âœ“ Ù‚Ø¨ÙˆÙ„</button>
                            <button onclick="updateApplicationStatus({{ app.application_id }}, 'Rejected')" class="btn btn-danger" style="flex: 1;">âœ— Ø±ÙØ¶</button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div style="background: white; padding: 3rem; border-radius: 0.75rem; text-align: center;">
            <p style="color: #6b7280; font-size: 1.1rem;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>
        </div>
    {% endif %}
</div>
{% endblock %}
